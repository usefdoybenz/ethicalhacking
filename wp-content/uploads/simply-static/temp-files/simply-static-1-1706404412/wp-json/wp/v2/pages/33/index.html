{"id":33,"date":"2024-01-28T02:01:48","date_gmt":"2024-01-28T01:01:48","guid":{"rendered":"https:\/\/localhost\/ethicalhacking\/?page_id=33"},"modified":"2024-01-28T02:01:48","modified_gmt":"2024-01-28T01:01:48","slug":"sql-and-no-sql-login-injections","status":"publish","type":"page","link":"https:\/\/localhost\/ethicalhacking\/sql-and-no-sql-login-injections\/","title":{"rendered":"SQL and No SQL login Injections"},"content":{"rendered":"\n<p>Definici\u00f3n seg\u00fan ChatGPT:<\/p>\n\n\n\n<p><strong>Inyecci\u00f3n SQL:<\/strong> La inyecci\u00f3n SQL es una vulnerabilidad de seguridad que ocurre cuando los datos no se validan o se filtran adecuadamente antes de ser enviados a un servidor SQL. Los atacantes pueden manipular las consultas SQL a trav\u00e9s de la entrada de datos para ejecutar comandos no autorizados en la base de datos, lo que podr\u00eda resultar en la divulgaci\u00f3n de informaci\u00f3n sensible o la modificaci\u00f3n\/eliminaci\u00f3n no autorizada de datos.<\/p>\n\n\n\n<p><strong>NoSQL Injection:<\/strong> La inyecci\u00f3n NoSQL es una variante de la inyecci\u00f3n de SQL, pero se dirige a bases de datos NoSQL en lugar de bases de datos SQL tradicionales. Al igual que en la inyecci\u00f3n SQL, los atacantes explotan fallos en la validaci\u00f3n de datos para manipular las consultas a bases de datos NoSQL y realizar acciones no autorizadas. Esto puede incluir la recuperaci\u00f3n de datos sensibles o la alteraci\u00f3n de la l\u00f3gica de la aplicaci\u00f3n que utiliza la base de datos NoSQL.<\/p>\n\n\n\n<p>Usaremos los payloads de githab para casa caso.<\/p>\n\n\n\n<blockquote class=\"wp-block-quote\">\n<p><strong>>>>Login SQL payload:<\/strong><\/p>\n<\/blockquote>\n\n\n\n<p><a href=\"https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/SQL%20Injection\">https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/SQL%20Injection<\/a><\/p>\n\n\n\n<p>En ese case nos encontramos ante un panel de autenticaci\u00f3n que utiliza servidor web Apache y un motor de b\u00fasqueda MySql, para burlar el accesso podremos injectar un listado de comandos de  hasta dar con el adecuado que nos permitira autenticar son conocer el usuario y contrase\u00f1a, el ejemplo de abajo pertence a la m\u00e1quina Writer de HTB (10.10.11.101)<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"424\" height=\"438\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-7.png\" alt=\"\" class=\"wp-image-34\" style=\"width:669px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"803\" height=\"856\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-8.png\" alt=\"\" class=\"wp-image-35\" style=\"width:668px;height:auto\"\/><\/figure>\n\n\n\n<p>En este caso se ha podido burlar la autenticaci\u00f3n usando el comando siguiente:<strong> <mark style=\"background-color:rgba(0, 0, 0, 0)\" class=\"has-inline-color has-foreground-color\">admin&#8217; &#8212; &#8211;<\/mark><\/strong><\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"345\" height=\"360\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-9.png\" alt=\"\" class=\"wp-image-36\" style=\"width:687px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"771\" height=\"284\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-10.png\" alt=\"\" class=\"wp-image-37\" style=\"width:684px;height:auto\"\/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>>>>Login No SQL payload:<\/strong><\/p>\n\n\n\n<p><a href=\"https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/NoSQL%20Injection\">https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/NoSQL%20Injection<\/a><\/p>\n\n\n\n<p>Para este caso usaremos el panel de autenticacion de la m\u00e1quina NodeBlog (10.10.11.139) de Hack The Box la cual utiliza la base de datos MongoDB y Nginx como servidor web, en un primer intento de login se descubre que el usuario admin existe pero ser\u00e1 necesario burlar la autenticaci\u00f3n ya que no conocemos la contrase\u00f1a:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"463\" height=\"277\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-11.png\" alt=\"\" class=\"wp-image-38\" style=\"width:695px;height:auto\"\/><\/figure>\n\n\n\n<p>Con este ejemplo usaremos Burpsuite Y FoxyProxy para intereceptar la comuncaci\u00f3n que enviamos desde el navegador al servidor web, y tras probar varios payload que nos ofrece el sitio de github arriba indicado conseguimos acceder al panel de administraci\u00f3n, el comando se env\u00eda en formato JSON:<\/p>\n\n\n\n<p>{\u00abuser\u00bb:\u00bbadmin\u00bb, \u00abpassword\u00bb: {\u00ab$ne\u00bb: null}}<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"817\" height=\"599\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-12.png\" alt=\"\" class=\"wp-image-39\" style=\"width:693px;height:auto\"\/><\/figure>\n\n\n\n<p>Al enviar el payload obtenemos una respuesta que nos dirige al panel de blog ya que hemos conseguido burlar la autenticacion, el payload env\u00eda una comando donde el user es admin y la password no es null o campo vac\u00edo, el motor de b\u00fasqueda lo interpret\u00f3 como un dato v\u00e1lido.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"511\" height=\"863\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-15.png\" alt=\"\" class=\"wp-image-42\" style=\"width:688px;height:auto\"\/><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Definici\u00f3n seg\u00fan ChatGPT: Inyecci\u00f3n SQL: La inyecci\u00f3n SQL es una vulnerabilidad de seguridad que ocurre cuando los datos no se validan o se filtran adecuadamente antes de ser enviados a un servidor SQL. Los atacantes pueden manipular las consultas SQL a trav\u00e9s de la entrada de datos para ejecutar comandos no autorizados en la base [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33"}],"collection":[{"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/comments?post=33"}],"version-history":[{"count":1,"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33\/revisions"}],"predecessor-version":[{"id":43,"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33\/revisions\/43"}],"wp:attachment":[{"href":"https:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/media?parent=33"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}