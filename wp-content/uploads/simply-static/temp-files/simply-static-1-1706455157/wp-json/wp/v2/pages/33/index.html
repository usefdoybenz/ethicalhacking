{"id":33,"date":"2024-01-28T16:13:23","date_gmt":"2024-01-28T15:13:23","guid":{"rendered":"https:\/\/localhost\/ethicalhacking\/?page_id=33"},"modified":"2024-01-28T16:16:57","modified_gmt":"2024-01-28T15:16:57","slug":"inyeccionesdeloginsqlnosql","status":"publish","type":"page","link":"http:\/\/localhost\/ethicalhacking\/inyeccionesdeloginsqlnosql\/","title":{"rendered":"Inyecciones de Login SQL + NoSQL"},"content":{"rendered":"\n<p>Definici\u00f3n:  <\/p>\n\n\n\n<p class=\"has-text-align-left\"><strong>Inyecci\u00f3n SQL:<\/strong> La inyecci\u00f3n SQL es una vulnerabilidad de seguridad que ocurre cuando los datos no se validan o se filtran adecuadamente antes de ser enviados a un servidor SQL. Los atacantes pueden manipular las consultas SQL a trav\u00e9s de la entrada de datos para ejecutar comandos no autorizados en la base de datos, lo que podr\u00eda resultar en la divulgaci\u00f3n de informaci\u00f3n sensible o la modificaci\u00f3n\/eliminaci\u00f3n no autorizada de datos.<\/p>\n\n\n\n<p><strong>NoSQL Injection:<\/strong> La inyecci\u00f3n NoSQL es una variante de la inyecci\u00f3n de SQL, pero se dirige a bases de datos NoSQL en lugar de bases de datos SQL tradicionales. Al igual que en la inyecci\u00f3n SQL, los atacantes explotan fallos en la validaci\u00f3n de datos para manipular las consultas a bases de datos NoSQL y realizar acciones no autorizadas. Esto puede incluir la recuperaci\u00f3n de datos sensibles o la alteraci\u00f3n de la l\u00f3gica de la aplicaci\u00f3n que utiliza la base de datos NoSQL.<\/p>\n\n\n\n<p>Usaremos los comando de inyecci\u00f3n que nos ofrece los payloads del sitio de Githab para casa caso.<\/p>\n\n\n\n<blockquote class=\"wp-block-quote\">\n<p><strong>&gt;&gt;&gt;Login SQL payload:<\/strong><\/p>\n<\/blockquote>\n\n\n\n<p><a href=\"https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/SQL%20Injection\">https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/SQL%20Injection<\/a><\/p>\n\n\n\n<p>En ese case nos encontramos ante un panel de autenticaci\u00f3n que utiliza servidor web Apache y un motor de b\u00fasqueda MySql, para burlar el acceso podremos inyectar un listado de comandos hasta dar con el adecuado que nos permitir\u00e1 autenticar sin disponer de usuario y contrase\u00f1a, el ejemplo de abajo pertenece a la m\u00e1quina Writer de HTB (10.10.11.101)<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"424\" height=\"438\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-7.png\" alt=\"\" class=\"wp-image-34\" style=\"width:669px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"803\" height=\"856\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-8.png\" alt=\"\" class=\"wp-image-35\" style=\"width:668px;height:auto\"\/><\/figure>\n\n\n\n<p>En este caso se ha podido burlar la autenticaci\u00f3n usando el comando siguiente:<strong> <mark style=\"background-color:rgba(0, 0, 0, 0)\" class=\"has-inline-color has-foreground-color\">admin&#8217; &#8212; &#8211;<\/mark><\/strong><\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"345\" height=\"360\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-9.png\" alt=\"\" class=\"wp-image-36\" style=\"width:687px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"771\" height=\"284\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-10.png\" alt=\"\" class=\"wp-image-37\" style=\"width:691px;height:auto\"\/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>&gt;&gt;&gt;Login No SQL payload:<\/strong><\/p>\n\n\n\n<p><a href=\"https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/NoSQL%20Injection\">https:\/\/github.com\/swisskyrepo\/PayloadsAllTheThings\/tree\/master\/NoSQL%20Injection<\/a><\/p>\n\n\n\n<p>Para este caso usaremos el panel de autenticaci\u00f3n de la m\u00e1quina NodeBlog (10.10.11.139) de Hack The Box, esta m\u00e1quina  utiliza la base de datos MongoDB y Nginx como servidor web, en un primer intento de login se descubre que el usuario admin existe debido a que el mensaje de error solo se\u00f1ala invalida la contrase\u00f1a y no al usuario admin, pero ser\u00e1 necesario burlar la autenticaci\u00f3n debido que no conocemos la contrase\u00f1a:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"345\" height=\"389\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-17.png\" alt=\"\" class=\"wp-image-49\" style=\"width:684px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"439\" height=\"456\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-18.png\" alt=\"\" class=\"wp-image-50\" style=\"width:692px;height:auto\"\/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"624\" height=\"410\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-16.png\" alt=\"\" class=\"wp-image-48\" style=\"width:697px;height:auto\"\/><\/figure>\n\n\n\n<p>Con este ejemplo usaremos Burpsuite Y FoxyProxy para interceptar la comunicaci\u00f3n que enviamos desde el navegador al servidor web y tras probar varios comandos que nos ofrece el payload de Github arriba indicado conseguimos acceder al panel de administraci\u00f3n, el comando se env\u00eda en formato JSON:<\/p>\n\n\n\n<p>{\u00abuser\u00bb:\u00bbadmin\u00bb, \u00abpassword\u00bb: {\u00ab$ne\u00bb: null}}<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"817\" height=\"599\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-12.png\" alt=\"\" class=\"wp-image-39\" style=\"width:692px;height:auto\"\/><\/figure>\n\n\n\n<p>Al enviar esta instrucci\u00f3n  hemos conseguido burlar la autenticaci\u00f3n, el payload env\u00eda un comando donde se indica que el user es admin (algo que ya hemos descubierto anteriormente ) y el campo  password no es null, es decir no es un campo vac\u00edo y el motor de b\u00fasqueda lo interpret\u00f3 como un dato v\u00e1lido, lo cual en la l\u00f3gica de programaci\u00f3n es un dato true o verdadero y el acceso es concedido al panel de Administraci\u00f3n.  <\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"511\" height=\"863\" src=\"https:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/01\/image-15.png\" alt=\"\" class=\"wp-image-42\" style=\"width:688px;height:auto\"\/><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Definici\u00f3n: Inyecci\u00f3n SQL: La inyecci\u00f3n SQL es una vulnerabilidad de seguridad que ocurre cuando los datos no se validan o se filtran adecuadamente antes de ser enviados a un servidor SQL. Los atacantes pueden manipular las consultas SQL a trav\u00e9s de la entrada de datos para ejecutar comandos no autorizados en la base de datos, [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33"}],"collection":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/comments?post=33"}],"version-history":[{"count":6,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33\/revisions"}],"predecessor-version":[{"id":58,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/33\/revisions\/58"}],"wp:attachment":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/media?parent=33"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}