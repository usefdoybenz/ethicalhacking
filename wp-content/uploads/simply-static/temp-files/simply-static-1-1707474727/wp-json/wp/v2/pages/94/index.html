{"id":94,"date":"2024-02-09T11:29:16","date_gmt":"2024-02-09T10:29:16","guid":{"rendered":"http:\/\/localhost\/ethicalhacking\/?page_id=94"},"modified":"2024-02-09T11:29:16","modified_gmt":"2024-02-09T10:29:16","slug":"manipulacion-decookieataque-de-padding-oracle","status":"publish","type":"page","link":"http:\/\/localhost\/ethicalhacking\/manipulacion-decookieataque-de-padding-oracle\/","title":{"rendered":"Manipulaci\u00f3n de Cookie (ataque de Padding Oracle)"},"content":{"rendered":"\n<p>Definici\u00f3n:<\/p>\n\n\n\n<p>Un \u00abPadding Oracle\u00bb es una vulnerabilidad criptogr\u00e1fica que se aprovecha al manipular el relleno (padding) en mensajes cifrados. Este tipo de ataque suele centrarse en sistemas que utilizan cifrado de bloques en modos como CBC (Cipher Block Chaining). El atacante intenta deducir informaci\u00f3n sensible al analizar las respuestas del sistema (oracle) a errores de relleno en los mensajes cifrados.<\/p>\n\n\n\n<p>PadBuster es una herramienta de prueba de penetraci\u00f3n utilizada para llevar a cabo ataques de Padding Oracle en aplicaciones web que utilizan cifrado en bloques, utilizando esta t\u00e9cnica se puede manipular una cookie con el objetivo de conocer el patr\u00f3n de  cifrado de la misma  y obtener otra cookie que nos permita acceder a la sesi\u00f3n de un usuario no autorizado.<\/p>\n\n\n\n<p>Para esta t\u00e9cnica se va a emplear la m\u00e1quina Lazy de la plataforma de Hack The Box (10.10.10.18).<\/p>\n\n\n\n<p>El usuario admin de la m\u00e1quina tiene privilegios, pero como no conocemos la contrase\u00f1a vamos a proceder a realizar un ataque con la herramienta Padbuster  y obtener su cookie de sesi\u00f3n.<\/p>\n\n\n\n<p>Primero debemos conocer la cookie de un usuario normal, en este caso el usuario se llama tester123 : <\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"809\" height=\"415\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-10.png\" alt=\"\" class=\"wp-image-95\" style=\"width:882px;height:auto\"\/><\/figure>\n\n\n\n<p>Utilizando la herramienta de desarrollo del propio navegador podemos visualizar la cookie del usuario tester123 : <\/p>\n\n\n\n<p>b9Znp%2FQiNZn7bs4KSAjBrepi%2BTBR0Mb5<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1914\" height=\"395\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-12.png\" alt=\"\" class=\"wp-image-97\" style=\"width:887px;height:auto\"\/><\/figure>\n\n\n\n<p>A continuaci\u00f3n ejecutamos la herramienta padbuster que apunta al sitio web y emplea la cookie para analizar el patr\u00f3n de cifrado, durante esta primera fase ser\u00e1 necesario seleccionar las opciones recomendadas:<\/p>\n\n\n\n<p>padbuster http:\/\/10.10.10.18\/index.php &#8216;b9Znp%2FQiNZn7bs4KSAjBrepi%2BTBR0Mb5&#8217; 8 -cookies &#8216;auth=b9Znp%2FQiNZn7bs4KSAjBrepi%2BTBR0Mb5&#8217;<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1388\" height=\"463\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-13.png\" alt=\"\" class=\"wp-image-98\" style=\"width:893px;height:auto\"\/><\/figure>\n\n\n\n<p>La primera fase concluye y como podemos observar que el cifrado de bloques que emplea esta herramienta funciona correctamente y nos muestra el valor de la cookie del usuario tester123: user=tester123<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"991\" height=\"234\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-14.png\" alt=\"\" class=\"wp-image-99\" style=\"width:894px;height:auto\"\/><\/figure>\n\n\n\n<p>En la siguiente fase vamos a  emplear de nuevo la herramienta padbuster  pero esta vez siguiendo el patr\u00f3n de cifrado le vamos a solicitar que nos crea una cookie de sesi\u00f3n  donde se cumpla  user=admin, es decir, obtener la cookie de sesi\u00f3n del usuario administrador:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"900\" height=\"181\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-15.png\" alt=\"\" class=\"wp-image-100\" style=\"width:908px;height:auto\"\/><\/figure>\n\n\n\n<p>Finalmente la hemos obtenido: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA<\/p>\n\n\n\n<p>A continuaci\u00f3n, simplemente la sustituimos  por la cookie del usuario tester123 y eso nos permite convertirnos en usuario administrador:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1918\" height=\"417\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-18.png\" alt=\"\" class=\"wp-image-103\" style=\"width:914px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"873\" height=\"330\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-16.png\" alt=\"\" class=\"wp-image-101\" style=\"width:910px;height:auto\"\/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Definici\u00f3n: Un \u00abPadding Oracle\u00bb es una vulnerabilidad criptogr\u00e1fica que se aprovecha al manipular el relleno (padding) en mensajes cifrados. Este tipo de ataque suele centrarse en sistemas que utilizan cifrado de bloques en modos como CBC (Cipher Block Chaining). El atacante intenta deducir informaci\u00f3n sensible al analizar las respuestas del sistema (oracle) a errores de [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/94"}],"collection":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/comments?post=94"}],"version-history":[{"count":3,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/94\/revisions"}],"predecessor-version":[{"id":158,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/94\/revisions\/158"}],"wp:attachment":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/media?parent=94"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}