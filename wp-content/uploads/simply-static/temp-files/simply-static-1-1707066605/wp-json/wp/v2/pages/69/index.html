{"id":69,"date":"2024-02-04T18:06:54","date_gmt":"2024-02-04T17:06:54","guid":{"rendered":"http:\/\/localhost\/ethicalhacking\/?page_id=69"},"modified":"2024-02-04T18:06:54","modified_gmt":"2024-02-04T17:06:54","slug":"path-traversal","status":"publish","type":"page","link":"http:\/\/localhost\/ethicalhacking\/path-traversal\/","title":{"rendered":"Intrusi\u00f3n en rutas no autorizadas (Path Traversal)"},"content":{"rendered":"\n<p>Definici\u00f3n:<\/p>\n\n\n\n<p>Path traversal es una vulnerabilidad de seguridad inform\u00e1tica que ocurre cuando un atacante intenta acceder o manipular archivos y directorios fuera de la ruta original prevista por una aplicaci\u00f3n. Este tipo de ataque explota la falta de restricciones adecuadas en la validaci\u00f3n de las rutas de archivo, permitiendo al atacante navegar a trav\u00e9s de directorios no autorizados y acceder a informaci\u00f3n confidencial o ejecutar c\u00f3digo malicioso. <\/p>\n\n\n\n<p>Para este ejemplo utilizaremos la m\u00e1quina Inject de la plataforma Hack The box (10.10.11.204)<\/p>\n\n\n\n<p>En el sitio web encontramos una ruta que permite subir un archivo, en este caso una im\u00e1gen:<\/p>\n\n\n\n<p>http:\/\/10.10.11.204:8080\/upload <\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"807\" height=\"347\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image.png\" alt=\"\" class=\"wp-image-70\" style=\"width:1128px;height:auto\"\/><\/figure>\n\n\n\n<p>Al subir un archivo (anonymous.jpg) y visualizarlo nos muestra la ruta donde se ha almacenado:<\/p>\n\n\n\n<p>http:\/\/10.10.11.204:8080\/show_image?img=anonymous.jpg<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"788\" height=\"167\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-1.png\" alt=\"\" class=\"wp-image-71\" style=\"width:1126px;height:auto\"\/><\/figure>\n\n\n\n<p>La ruta show_image?img= est\u00e1 apuntando a un archivo existente, lo que nos permite explotar la vulnerabilidad de enumerar archivos y directorios internos del servidor web, con esto conseguimos leer el archivo passwd y enumerar usuarios de la m\u00e1quina, por tanto, con esta intrusi\u00f3n tenemos capacidad de directory listing que nos permite enumerar archivos cr\u00edticos, por ejemplo los de la ruta \/var .<\/p>\n\n\n\n<p>Para poder realizar esto en este caso utilizamos la herramienta Burpsuite que act\u00faa como un proxy entre en el navegador y el servidor web interceptando la comunicaci\u00f3n HTTP:<\/p>\n\n\n\n<p>\/show_image?img=..\/..\/..\/..\/..\/..\/etc\/passwd<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"825\" height=\"394\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-2.png\" alt=\"\" class=\"wp-image-72\" style=\"width:1124px;height:auto\"\/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"820\" height=\"831\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-3.png\" alt=\"\" class=\"wp-image-73\" style=\"width:1121px;height:auto\"\/><\/figure>\n\n\n\n<p>\/show_image?img=..\/..\/..\/..\/..\/..\/var\/www\/WebApp<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"1274\" height=\"433\" src=\"http:\/\/localhost\/ethicalhacking\/wp-content\/uploads\/2024\/02\/image-4.png\" alt=\"\" class=\"wp-image-74\" style=\"width:1153px;height:auto\"\/><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Definici\u00f3n: Path traversal es una vulnerabilidad de seguridad inform\u00e1tica que ocurre cuando un atacante intenta acceder o manipular archivos y directorios fuera de la ruta original prevista por una aplicaci\u00f3n. Este tipo de ataque explota la falta de restricciones adecuadas en la validaci\u00f3n de las rutas de archivo, permitiendo al atacante navegar a trav\u00e9s de [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"footnotes":""},"_links":{"self":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/69"}],"collection":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/comments?post=69"}],"version-history":[{"count":3,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/69\/revisions"}],"predecessor-version":[{"id":80,"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/pages\/69\/revisions\/80"}],"wp:attachment":[{"href":"http:\/\/localhost\/ethicalhacking\/wp-json\/wp\/v2\/media?parent=69"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}